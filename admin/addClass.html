<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8">
    <title></title>
    <link rel="stylesheet" href="css/bootstrap.css"/>
    <link rel="stylesheet" href="css/addBook.css"/>
    <script src="js/vue.js"></script>
    <script type="text/javascript" src="js/jquery.js"></script>
    <script type="text/javascript" src="../js/url.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script type="text/javascript" src="js/ajaxfileupload.js"></script>
</head>
<script type="text/javascript">
    function fileChange() {
        $.ajaxFileUpload({
            url: "/prod/ajaxImg.action",
            secureuri: false,
            fileElementId: 'pimage',
            dataType: "json",
            success: function (obj) {
                //清空div
                $("#imgDiv").empty();
                //创建一个图片的标签
                var imgObj = $("<img>");
                alert(obj.imgurl);
                imgObj.attr("src", "/image_big/" + obj.imgurl);
                imgObj.attr("width", "100px");
                imgObj.attr("height", "100px");
                //将图片追加到imgDiv
                $("#imgDiv").append(imgObj);
            }
        });

    }
</script>
<body>
<!--取出上一个页面上带来的page的值-->

<div id="addAll">
    <div id="nav">
        <p>课程管理>新增课程</p>
    </div>

    <div id="table">
        <form id="myform" onsubmit="submitNo(event)">
            <table>
                <tr>
                    <td class="one">课程名称</td>
                    <td><input type="text" name="pName" class="two" v-model="video_name" ></td>
                </tr>
                <tr>
                    <td class="one">课程介绍</td>
                    <td><input type="text" name="pContent" class="two" v-model="description"></td>
                </tr>
                <tr>
                    <td class="one">课程时长</td>
                    <td><input type="text" name="pNumber" class="two" v-model="time"></td>
                </tr>
                <tr>
                    <td class="one">上传时间</td>
                    <td><input type="text" name="pNumber" class="two" v-model="load_time"></td>
                </tr>
                <tr>
                    <td class="one">点击量</td>
                    <td><input type="text" name="pNumber" class="two" v-model="click"></td>
                </tr>
                <tr>
                    <td class="one">视频路径</td>
                    <td><input type="text" name="pNumber" class="two" v-model="video_path"></td>
                </tr>
                <tr>
                    <td class="one">图片路径</td>
                    <td><input type="text" name="pNumber" class="two" v-model="picture_path"></td>
                </tr>
                <tr>
                    <td class="one">用户id</td>
                    <td><input type="text" name="pNumber" class="two" v-model="user_id"></td>
                </tr>
                <tr>
                    <td class="one">类型id</td>
                    <td><input type="text" name="pNumber" class="two" v-model="type_id"></td>
                </tr>
                <tr>
                    <td class="one">价格</td>
                    <td><input type="text" name="pNumber" class="two" v-model="price"></td>
                </tr>

                <tr>
                    <td>
                        <input type="submit" value="提交" class="btn btn-success">
                    </td>
                    <td>
                        <input type="reset" value="取消" class="btn btn-default" onclick="myclose()">
                        <script type="text/javascript">
                            function myclose(ispage) {
                                // window.location = "/prod/split.action?page=" + ispage;
                                //两种风格跳转
                                // window.location = "manageUser.html" ;
                                window.location = "manageClass.html" ;
                            }
                        </script>
                    </td>
                </tr>
            </table>
        </form>
    </div>
</div>

</body>
<script>
    let vm = new Vue({
        el:"#addAll",
        data:{
            video_id:0,
            video_name:"666",
            description:"",
            time:"",
            load_time:"",
            click:0,
            video_path:"",
            picture_path:"",
            user_id:0,
            type_id:0,
            price:""
        },
        mounted:function (){
            //接受用户上传时的用户id
            var getRequest = GetRequest();
            var userId = getRequest['userId'];
            this.user_id=userId
            console.log(this.user_id)
        }
    })
 //表单的异步提交
 function submitNo(e){
     e.preventDefault()
     console.log(vm.cName)
     $.ajax({
         url:"http://localhost:3000/addClass",
         type: "post",
         dataType:"json",
         data:{
             // obj:{"cName":vm.cName,"cid":vm.cid,"cPrice":vm.cPrice,"cNo":vm.cNo}
             obj:{"video_id":vm.video_id,"video_name":vm.video_name,"description":vm.description,
                 "time":vm.time,"load_time":vm.load_time,"click":vm.click,"video_path":vm.video_path,"picture_path":vm.picture_path,"user_id":vm.user_id,
                 "type_id":vm.type_id,"cNo":vm.price
             }
         },
         success:function (){
             window.location.href="manageClass.html"
         }
     })
 }
</script>
</html>