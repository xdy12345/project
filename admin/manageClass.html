<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <script type="text/javascript" src="js/jQuery1.js"></script>
    <script type="text/javascript" src="js/bootstrap.js"></script>
    <script type="text/javascript">
        if ("" != "") {
            alert("");
        }
        $(function () {
            let ajaxsplit = function (page) {
                //发送ajax请求  jQuery的方式发送
                $.ajax({
                    url: "/prod/ajaxSplit.action",
                    data: {"page": page},
                    type: "post",
                    success: function () {
                        //重新加载显示数据的容器
                        #table.load("http://localhost:8080/admin/product.jsp #table");
                    }
                });

            }
        });
    </script>


    <link rel="stylesheet" href="css/bootstrap.css"/>
    <link rel="stylesheet" href="css/bright.css"/>
    <link rel="stylesheet" href="css/addBook.css"/>


    <title></title>
</head>
<script type="text/javascript">
    $(function (){

    });

    //全选复选框功能实现
    function allClick() {
        //获得当前点击后全选按钮的状态
        var flag = $("#all").prop("checked");
        //将此状态赋值给下面五个复选框
        $("input[name='ck']").each(function () {
            this.checked = flag;
        });
    }

    //单个复选框点击改变全选复选框功能实现
    function ckClick() {

        //得到下面五个复选框的个数
        var fiveLength = $("input[name='ck']").length;
        //得到下面五个复选框被选中的个数
        var checkedLength = $("input[name='ck']:checked").length;
        //进行对比,改变全选复选框的状态
        if (fiveLength == checkedLength) {
            $("#all").prop("checked", true);
        } else {
            $("#all").prop("checked", false);
        }
    }
</script>
<body>
<div id="brall">
    <div id="nav">
        <p>课程管理>课程列表</p>
    </div>
    <div id="condition" style="text-align: center">
        <form id="myform" action="err.html">
            课程名称：<input name="pname" id="pname">&nbsp;&nbsp;&nbsp;
            课程类型：<select name="typeid" id="typeid">
            <option value="-1">请选择</option>
            <option>java</option>
            <option>c++</option>
            <option>jquery</option>

        </select>&nbsp;&nbsp;&nbsp;
            价格：<input name="lprice" id="lprice">-<input name="hprice" id="hprice">
            <input type="submit" value="提交">
        </form>
    </div>
    <br>
    <div id="table">


        <div id="top">
            <input type="checkbox" id="all" onclick="allClick()" style="margin-left: 50px">&nbsp;&nbsp;全选
            <a href="addClass.html">

                <input type="button" class="btn btn-warning" id="btn1"
                       value="新增课程">
            </a>
            <input type="button" class="btn btn-warning" id="btn1" name="delall"
                   value="批量删除" >
        </div>
        <!--显示分页后的商品-->

        <div id="middle">
            <table class="table table-bordered table-striped">
                <tr>
                    <th></th>
                    <th>课程名</th>
                    <th>课程介绍</th>
                    <th>定价（元）</th>
                    <th>课程图片</th>
                    <th>课程数量</th>
                    <th>操作</th>
                </tr>
                <tr>
                    <td valign="center" align="center">
                        <input type="checkbox" name="ck" id="ck"  ></td>
                    <td>java</td>
                    <td>java必学</td>
                    <td>100.0元</td>
                    <td><img width="55px" height="45px"
                             src="img/img.png"></td>
                    <td>1</td>
                    <td>
                        <button type="button" class="btn btn-info "
                        >编辑
                        </button>
                        <button type="button" class="btn btn-warning" id="mydel" name="mydel"
                        >删除
                        </button>
                    </td>
                </tr>
                <tr>
                    <td valign="center" align="center">
                        <input type="checkbox" name="ck" id="ck"  ></td>
                    <td>java</td>
                    <td>java必学</td>
                    <td>100.0元</td>
                    <td><img width="55px" height="45px"
                             src="img/img.png"></td>
                    <td>1</td>
                    <td>
                        <button type="button" class="btn btn-info "
                        >编辑
                        </button>
                        <button type="button" class="btn btn-warning" id="mydel" name="mydel"
                        >删除
                        </button>
                    </td>
                </tr>


            </table>
            <!--分页栏-->
            <div id="bottom">
                <div>
                    <nav aria-label="..." style="text-align:center;">
                        <ul class="pagination">
                            <li>

                                <a href="#" aria-label="Previous">

                                    <span aria-hidden="true">«</span></a>
                            </li>
                            <li>

                                <a href="#" aria-label="Previous">

                                    <span aria-hidden="true">1</span></a>
                            </li>
                            <li>

                                <a href="#" aria-label="Previous">

                                    <span aria-hidden="true">2</span></a>
                            </li>
                            <li>

                                <a href="#" aria-label="Previous">

                                    <span aria-hidden="true">...</span></a>
                            </li>


                            <li>

                                <a name="next" href="#"  aria-label="Next">
                                    <span aria-hidden="true">»</span></a>
                            </li>
                            <li style=" margin-left:150px;color: #0e90d2;height: 35px; line-height: 35px;">总共&nbsp;&nbsp;&nbsp;<font
                                    style="color:orange;"></font>&nbsp;&nbsp;&nbsp;页&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;

                                当前&nbsp;&nbsp;&nbsp;<font
                                        style="color:orange;"></font>&nbsp;&nbsp;&nbsp;页&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;


                            </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </div>


    </div>
</div>
</body>

<script type="text/javascript">
    //单个删除的jquery实现
    $("button[name='mydel']").click(function (){
        alert("确定删除吗？");
        $(this).parent().parent("tr").remove();
    });
    //批量删除
    $("input[name='delall']").click(function (){
        var list= $("input[name='ck']:checked");
        console.log(list)
        //console.log($("input[name='ck']:checked").parent().parent().remove());
        if (list.length>0){
            list.each(function (){
                // console.log(list)
                console.log($(this).parent().parent("tr").remove());

            })
        }
        else {
            alert("请选择要删除的数据")
        }
    });

    function mysubmit() {
        $("#myform").submit();
    }

    //批量删除
    function deleteBatch() {
        //得到所有选中复选框的对象,根据其长度判断是否有选中商品
        var cks = $("input[name='ck']:checked");  //1,4,5
        //如果有选中的商品
        if (cks.length == 0) {
            alert("请先选择将要删除的商品!");
        } else {
            var str = "";
            var pid = "";
            if (confirm("您确定要删除" + cks.length + "条商品吗?")) {
                // alert("可以进行删除!");
                //获取其value的值,进行字符串拼接
                $.each(cks, function () {
                    pid = $(this).val();
                    //进行非空判断,避免出错
                    if (pid != null) {
                        str += pid + ",";  //145   ===>1,4,5,
                    }
                });

                //发送ajax请求,进行批量删除的提交
                $.ajax({
                    url: "/prod/deleteBatch.action",
                    data: {"pids": str},
                    type: "post",
                    dataType: "text",
                    success: function (msg) {
                        alert(msg);//批量删除成功!失败!不可删除!
                        //将页面上显示商品数据的容器重新加载
                        $("#table").load("http://localhost:8080/admin/product.jsp #table");
                    }
                });
            }
        }
    }

    //单个删除
    function del(pid, page) {
        //弹框提示
        if (confirm("您确定删除吗?")) {
            //发出ajax的请求,进行删除操作
            //取出查询条件
            var pname = $("#pname").val();
            var typeid = $("#typeid").val();
            var lprice = $("#lprice").val();
            var hprice = $("#hprice").val();
            $.ajax({
                url: "/prod/delete.action",
                data: {"pid": pid, "page": page, "pname": pname, "typeid": typeid, "lprice": lprice, "hprice": hprice},
                type: "post",
                dataType: "text",
                success: function (msg) {
                    alert(msg);
                    $("#table").load("http://localhost:8080/admin/product.jsp #table");
                }
            });
        }
    }

    function one(pid, page) {
        //取出查询条件
        var pname = $("#pname").val();
        var typeid = $("#typeid").val();
        var lprice = $("#lprice").val();
        var hprice = $("#hprice").val();
        //向服务器提交请求,传递商品id
        var str = "?pid=" + pid + "&page=" + page + "&pname=" + pname + "&typeid=" + typeid + "&lprice=" + lprice + "&hprice=" + hprice;
        location.href = "/prod/one.action" + str;
    }
</script>
<!--分页的AJAX实现-->
<script type="text/javascript">

    function ajaxsplit(page) {
        //发送ajax请求  jQuery的方式发送
        $.ajax({
            url: "/prod/ajaxSplit.action",
            data: {"page": page},
            type: "post",
            success: function () {
                //重新加载显示数据的容器
                #table.load("http://localhost:8080/admin/product.jsp #table");
            }
        });

    }


    function condition() {
        //取出查询条件
        var pname = $("#pname").val();
        var typeid = $("#typeid").val();
        var lprice = $("#lprice").val();
        var hprice = $("#hprice").val();
        $.ajax({
            type: "post",
            url: "/prod/ajaxSplit.action",
            data: {"pname": pname, "typeid": typeid, "lprice": lprice, "hprice": hprice},
            success: function () {
                //刷新显示数据的容器
                $("#table").load("http://localhost:8080/admin/product.jsp #table");
            }
        });
    }
</script>

</html>
